class App{constructor(){localStorage.getItem("user")||this._createStorage(),this._storage=localStorage.getItem("user"),this._loginBtn=document.getElementById("login-btn"),this._tabs=document.getElementById("tabs"),this._modal=document.getElementById("modal"),this._auth=document.getElementById("login-auth"),this._logout=document.getElementById("logout"),this._user=document.getElementById("user-text"),this._userInput=document.getElementById("user-textbox"),this._init()}_init(){this._checkRemember(),this._tabs.addEventListener("click",(e=>{const t=e.target;t.classList.contains("tab")&&(t.classList.contains("active")||(this._removeActiveClass(),t.classList.add("active"),this._showContentByTabClick(t.dataset.action)))})),this._loginBtn.addEventListener("click",(()=>this._modal.style.display="block")),this._modal.addEventListener("click",(()=>{const e=event.target.dataset.action;e&&this._clickHandleInModal(e)})),this._user.addEventListener("click",(()=>{this._userInput.style.display="block",this._userInput.value=this._user.textContent.trim(),this._userInput.focus(),this._user.style.display="none"})),this._userInput.addEventListener("blur",(()=>{this._setUsernameInHeader(this._userInput.value),this._userInput.style.display="none",this._user.style.display="block"})),this._logout.addEventListener("click",(()=>{const e=JSON.parse(this._storage);e.remember=!1,this._setStorage(e),this._auth.style.display="none",this._loginBtn.style.display="block"}))}_checkRemember(){const{remember:e,username:t}=JSON.parse(this._storage);e&&(this._authorizeUser(),this._user.textContent=t)}_clickHandleInModal(e){({"modal-close":()=>{this._clearModalInputs(),this._modal.style.display="none"},login:()=>{const[e,t,s]=Array.from(this._getModalInputs());this._checkEmptyInputs(e,t)&&(this._checkCorrectData(e.value,t.value,s.checked),this._clickHandleInModal.call(this,"modal-close"))}})[e]()}_checkCorrectData(e,t,s){const{login:n,password:a,username:o,remember:l}=JSON.parse(this._storage);if(n!==e.trim()||a!==t.trim())return alert("Неверный логин или пароль!");const i={login:n,password:a,username:o,remember:s};this._setStorage(i),this._authorizeUser(),this._setUsernameInHeader(o)}_authorizeUser(){this._loginBtn.style.display="none",this._auth.style.display="flex"}_setStorage(e){localStorage.setItem("user",JSON.stringify(e)),this._storage=localStorage.getItem("user")}_setUsernameInHeader(e){const t=JSON.parse(this._storage);t.username=e,this._user.textContent=e.trim(),this._setStorage(t)}_checkEmptyInputs(e,t){let s=!0;for(let n of[e,t])""===n.value&&(s=!1,n.style.backgroundColor="red",setTimeout((()=>n.style.backgroundColor=""),300));return s}_getModalInputs(){return this._modal.querySelectorAll("input")}_clearModalInputs(){this._getModalInputs().forEach((e=>e.checked?e.checked=!1:e.value=""))}_createStorage(){localStorage.setItem("user",JSON.stringify({login:"user",password:"111",remember:!1,username:"Иванов"}))}_showContentByTabClick(e){const t=document.getElementById("movies"),s=document.getElementById("genres"),n=document.getElementById("channels");({"show-movies":()=>{t.style.display="",s.style.display="",n.style.display="none"},"show-channels":()=>{t.style.display="none",s.style.display="none",n.style.display="flex"}})[e]()}_removeActiveClass(){this._tabs.querySelectorAll("div.tab").forEach((e=>e.classList.remove("active")))}}document.addEventListener("DOMContentLoaded",(()=>{const e=new App;console.log(e)}));